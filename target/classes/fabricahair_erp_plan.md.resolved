# FabricHair ERP â€” Plano de Arquitetura e MVP

Sistema ERP dedicado para fÃ¡brica e centro de distribuiÃ§Ã£o de produtos de cabelo.
Separado do HatsuHair ERP, mas integrÃ¡vel via API.

---

## VisÃ£o Geral

| Item | DecisÃ£o |
|---|---|
| **Stack** | Spring Boot 3 + PostgreSQL + Thymeleaf (mesma base do HatsuHair) |
| **Deploy** | Railway (novo projeto separado) |
| **NF-e** | IntegraÃ§Ã£o via [Focus NFe API](https://focusnfe.com.br/) |
| **Auth** | JWT + perfis (ADMIN, GERENTE, PRODUCAO, ESTOQUE, VENDAS, FINANCEIRO) |
| **IntegraÃ§Ã£o HatsuHair** | REST API para produtos/pedidos compartilhados |

---

## Arquitetura de MÃ³dulos

```
FabricHair ERP
â”œâ”€â”€ ğŸ­ ProduÃ§Ã£o
â”‚   â”œâ”€â”€ Ordens de ProduÃ§Ã£o (OP)
â”‚   â”œâ”€â”€ Fichas TÃ©cnicas de FormulaÃ§Ã£o
â”‚   â”œâ”€â”€ Controle de Lote / Validade
â”‚   â””â”€â”€ Controle de Qualidade
â”‚
â”œâ”€â”€ ğŸ“¦ Estoque
â”‚   â”œâ”€â”€ MatÃ©rias-Primas (Insumos)
â”‚   â”œâ”€â”€ Produtos Acabados
â”‚   â”œâ”€â”€ MovimentaÃ§Ãµes (Entrada / SaÃ­da / Ajuste)
â”‚   â””â”€â”€ Alertas de Estoque MÃ­nimo
â”‚
â”œâ”€â”€ ğŸ›’ Compras
â”‚   â”œâ”€â”€ Pedidos de Compra (PC)
â”‚   â”œâ”€â”€ Fornecedores
â”‚   â””â”€â”€ Recebimento de NF-e de entrada
â”‚
â”œâ”€â”€ ğŸ“¤ Vendas B2B
â”‚   â”œâ”€â”€ Clientes B2B (distribuidores, revendas, salÃµes)
â”‚   â”œâ”€â”€ Pedidos de Venda
â”‚   â”œâ”€â”€ Tabelas de PreÃ§o por perfil de cliente
â”‚   â””â”€â”€ OrÃ§amentos
â”‚
â”œâ”€â”€ ğŸ§¾ Fiscal
â”‚   â”œâ”€â”€ EmissÃ£o NF-e (Focus NFe API)
â”‚   â”œâ”€â”€ Certificado Digital A1
â”‚   â”œâ”€â”€ DANFE
â”‚   â””â”€â”€ Registro ANVISA por produto
â”‚
â”œâ”€â”€ ğŸ’° Financeiro
â”‚   â”œâ”€â”€ Contas a Receber
â”‚   â”œâ”€â”€ Contas a Pagar
â”‚   â”œâ”€â”€ Fluxo de Caixa
â”‚   â””â”€â”€ RelatÃ³rios (DRE simplificado)
â”‚
â””â”€â”€ ğŸ”— IntegraÃ§Ãµes
    â”œâ”€â”€ HatsuHair ERP (produtos e pedidos)
    â””â”€â”€ Transportadoras (CORREIOS / jadlog futuramente)
```

---

## Roadmap em Fases

### ğŸ”´ FASE 1 â€” Foundation (MVP Core) â€” 6â€“8 semanas

**Objetivo:** Sistema funcional para controlar produÃ§Ã£o e emitir NF-e

#### MÃ³dulos incluÃ­dos:
1. **Auth & UsuÃ¡rios** â€” JWT, perfis de acesso
2. **Produtos** â€” cadastro com NCM, ANVISA, lote, validade
3. **Insumos/MatÃ©rias-Primas** â€” cadastro, estoque  
4. **Ordens de ProduÃ§Ã£o (OP)** â€” criar OP, baixar insumos, registrar lote produzido
5. **Estoque** â€” movimentaÃ§Ãµes bÃ¡sicas
6. **Clientes B2B** â€” CNPJ, endereÃ§o de entrega, contato, limite de crÃ©dito
7. **Pedidos de Venda** â€” criar pedido, vincular cliente, itens com quantidade e preÃ§o
8. **NF-e de SaÃ­da** â€” integraÃ§Ã£o Focus NFe, emissÃ£o e DANFE

**EntregÃ¡vel:** Conseguir produzir um lote e vender com NF-e emitida.

---

### ğŸŸ¡ FASE 2 â€” OperaÃ§Ãµes Completas â€” 4â€“6 semanas

1. **Compras** â€” PC para fornecedores, recebimento, baixa no estoque
2. **Controle de Qualidade** â€” aprovaÃ§Ã£o de lote antes de liberar venda
3. **Tabela de PreÃ§os** â€” preÃ§o por perfil (atacado, distribuidor, varejo)
4. **Contas a Receber / Pagar** â€” vencimentos, status de pagamento
5. **Dashboard** â€” indicadores de produÃ§Ã£o, estoque crÃ­tico, vendas do mÃªs
6. **RelatÃ³rios** â€” produÃ§Ã£o por perÃ­odo, vendas por cliente, CMV

---

### ğŸŸ¢ FASE 3 â€” AvanÃ§ado â€” conforme demanda

1. **Rastreabilidade** â€” de qual lote de insumo veio qual produto acabado
2. **IntegraÃ§Ã£o HatsuHair** â€” pedidos do salÃ£o viram pedidos FabricHair
3. **ComissÃµes** â€” representantes de vendas externos
4. **Etiquetas/Labels** â€” geraÃ§Ã£o de etiqueta com QR Code do lote
5. **Multi-empresa/filial** â€” para crescimento futuro

---

## Modelo de Dados Principal

```
produtos_acabados (id, nome, sku, ncm, registro_anvisa, preco_custo, preco_venda_*)
insumos (id, nome, sku, unidade, estoque_atual, estoque_minimo, fornecedor_id)
lotes (id, produto_id, numero_lote, data_fabricacao, data_validade, quantidade, status)
ordens_producao (id, produto_id, quantidade_planejada, data_inicio, data_fim, status)
op_insumos (op_id, insumo_id, quantidade_necessaria, quantidade_usada)
clientes_b2b (id, razao_social, cnpj, ie, endereco, perfil_preco, limite_credito)
pedidos_venda (id, cliente_id, data, status, valor_total, nfe_chave)
pedidos_itens (id, pedido_id, produto_id, lote_id, quantidade, preco_unitario)
nfe (id, pedido_id, chave_acesso, status, ambiente, xml, pdf_danfe_url)
movimentacoes_estoque (id, produto_id, tipo, quantidade, motivo, referencia_id, data)
```

---

## IntegraÃ§Ã£o NF-e via Focus NFe

```java
// Exemplo simplificado da integraÃ§Ã£o
POST https://homologacao.focusnfe.com.br/v2/nfe
Authorization: Token SEU_TOKEN_FOCUS_NFE
{
  "natureza_operacao": "VENDA DE MERCADORIA",
  "forma_pagamento": 0,
  "emitente": { "cnpj": "...", "nome": "FabricHair Ltda" },
  "destinatario": { "cnpj": "...", "nome": "Cliente Distribuidora" },
  "itens": [{ "numero_item": 1, "codigo_ncm": "3305.90", ... }]
}
```

**Custo:** ~R$200/mÃªs para atÃ© 500 NF-e/mÃªs  
**BenefÃ­cio:** Elimina certificaÃ§Ã£o SEFAZ, assinatura XML, contingÃªncia â€” tudo gerenciado pela Focus.

---

## Stack TÃ©cnica Detalhada

```
Backend:   Spring Boot 3.x + Spring Security (JWT)
Database:  PostgreSQL (Railway)
Frontend:  Thymeleaf + Bootstrap 5 + Chart.js
Build:     Maven
Deploy:    Railway (novo serviÃ§o)
Fiscal:    Focus NFe REST API
Armazenamento: Railway Volume (PDFs DANFE, certificado A1)
```

---

## PrÃ³ximos Passos Imediatos

- [ ] Criar repositÃ³rio GitHub `FabricHair-ERP`
- [ ] Inicializar projeto Spring Boot com dependÃªncias base
- [ ] Definir schema inicial do banco (Flyway migrations)
- [ ] Implementar auth + usuÃ¡rios (FASE 1)
- [ ] Criar conta de teste na Focus NFe (ambiente de homologaÃ§Ã£o Ã© grÃ¡tis)
- [ ] Implementar cadastro de produtos com NCM e ANVISA
